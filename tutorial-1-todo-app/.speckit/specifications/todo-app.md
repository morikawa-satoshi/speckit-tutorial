# ToDoアプリ 機能仕様 (Specification)

## 概要
ブラウザのみで動作するシンプルなToDoリストアプリ。データはローカルストレージに保存し、追加・完了/未完了切替・削除・表示・フィルタに加えて優先度（高/中/低）の付与・フィルタ・並び替えを提供する。

## ユーザーストーリー

### US-1: ToDoアイテムを追加する
**として** ユーザー
**私は** 新しいタスクを追加したい
**なぜなら** やるべきことを記録したいから

**受け入れ基準**
- 入力欄にテキストを入力し、Enterまたは「追加」ボタンで登録できる
- 空・空白のみの入力は拒否する
- 追加後、リストに即時反映され、入力欄はクリアされる
- データは `localStorage` に保存される

### US-2: 完了/未完了を切り替える
**として** ユーザー
**私は** タスクを完了済みにマーク/解除したい
**なぜなら** 進捗を把握したいから

**受け入れ基準**
- チェックボックスまたは行クリックで完了/未完了をトグルできる
- 完了タスクは視覚的に区別（取り消し線や色）される
- 状態はリロード後も保持される

### US-3: タスクを削除する
**として** ユーザー
**私は** 不要なタスクを削除したい
**なぜなら** リストを整理したいから

**受け入れ基準**
- 各タスクに削除ボタン（Xなど）がある
- クリックで即時削除され、`localStorage` も更新される
- 確認ダイアログは不要（シンプルさ優先）

### US-4: タスクを表示・フィルタする
**として** ユーザー
**私は** すべて/未完了/完了済みのタスクを見たい
**なぜなら** 状態に応じて集中したいから

**受け入れ基準**
- 初期表示は「すべて」
- フィルタは「すべて / 未完了 / 完了済み」を切替でき、選択中が分かる
- フィルタ変更は即時反映される
- （任意）フィルタ状態は永続化しなくてよい

### US-5: 優先度を設定・活用する
**として** ユーザー
**私は** タスクに優先度（高/中/低）を付け、優先度でフィルタ・並び替えしたい
**なぜなら** 重要度に応じて作業を整理したいから

**受け入れ基準**
- 追加時に優先度を選択でき、既定値は「中」
- 各タスクに優先度が表示される
- 優先度でフィルタ（高/中/低/すべて）ができる
- 優先度で並び替え（高→中→低）と元の並び（作成日時降順）を切替できる

## 機能要件

### モデル
- `id`: 一意ID（タイムスタンプなど）
- `text`: タスク本文（最大200文字、トリム必須）
- `completed`: 真偽値
- `createdAt`: 作成日時
- `priority`: 優先度（`high` | `medium` | `low`、デフォルト`medium`）

### データ永続化
- 保存先: `localStorage`（キー: `todo-app-tasks`）
- 追加/更新/削除のたびに即時保存
- ページロード時に読み込み、パース失敗時は空配列に初期化

### UI要素
- 入力欄 + 追加ボタン（Enterでも追加）
- 優先度セレクト（高/中/低、デフォルト中）
- タスクリスト（スクロール可）
  - 完了トグル操作部位
  - タスク本文
  - 優先度表示（色やラベルで可視化）
  - 削除ボタン
- フィルタバー（すべて/未完了/完了済み）
- 優先度フィルタ（すべて/高/中/低）
- 並び替えトグル（作成日時降順 / 優先度降順）
- 未完了タスク数の表示

### バリデーション / フィードバック
- 空/空白のみは追加不可、200文字を超える入力は拒否
- エラー時は簡潔なメッセージ表示（短時間で消えるなど）
- 優先度は指定リスト外の値を受け付けない（セレクト固定）

## 非機能要件
- パフォーマンス: 100件程度でストレスなく操作、操作は体感即時
- アクセシビリティ: キーボード操作対応、適切なラベル/コントラスト
- レスポンシブ: スマホ〜デスクトップでレイアウトが崩れない

## エッジケース
- LocalStorageが使えない場合: 警告表示し、非永続モードで動作
- 破損データ: パースエラー時は空配列で再初期化
- 長文入力: 200文字上限で制御、表示は折返しまたは省略
- 優先度設定: 不正値は受け付けず既定値`medium`にフォールバック

## 成功基準
- 追加/完了トグル/削除/フィルタが仕様通り動作
- リロード後もデータが保持される
- キーボードだけで主要操作が可能
- 優先度フィルタ/並び替えが仕様通り動作し、視覚的にも識別できる
